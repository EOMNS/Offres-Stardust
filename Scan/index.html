<!DOCTYPE html>
<html>
<head>
  <title>Détection de texte en direct depuis la caméra</title>
</head>
<body>
  <video id="videoElement" width="400" height="300" autoplay></video>
  <div id="message" style="display: none;">
    <p>Le texte "Offre nº" a été détecté !</p>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2.3.0/dist/tesseract.js"></script>
  <script>
    const video = document.getElementById('videoElement');
    const messageDiv = document.getElementById('message');

    navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } })
      .then(stream => {
        video.srcObject = stream;
      })
      .catch(err => console.error('Accès à la caméra refusé : ', err));

    const worker = Tesseract.createWorker({
      logger: m => console.log(m),
    });

    worker.load().then(() => {
      worker.loadLanguage('eng');
      worker.initialize('eng');
      startTextDetection();
    });

    async function startTextDetection() {
      const { data: { text } } = await worker.recognize(video);

      if (text.includes('Offre nº')) {
        messageDiv.style.display = 'block';
      } else {
        messageDiv.style.display = 'none';
      }

      requestAnimationFrame(startTextDetection);
    }
  </script>
</body>
</html>